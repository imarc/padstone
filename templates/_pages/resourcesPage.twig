{% do view.registerJsFile(mix('/js/filtering.js')) %}
{% import "/_macros" as macros %}
{% set section = 'resourcesPage' %}
{% extends "_layouts/main" %}
{% block content %}
    {% include '_partials/hero' with entry %}

    <resources :params="params" v-slot="{ query, resources, isLoading, meta: { pagination  = {} } = {} }">
        <div class="section resultsSection">
            <div class="section__container container">

                <div class="filters">
                    <div class="filters__filter select">
                        <label for="resource_type" class="select__label">
                            Filter by Type:
                        </label>
                        <resource-types v-slot="{ resourceTypes }">
                            <select class="select__select" name="resource_type" v-model="params.type">
                                <option :value="null" selected>All</option>
                                <option v-for="resourceType in resourceTypes" :value="resourceType.slug" :key="resourceType.id" v-text="resourceType.title"></option>
                            </select>
                        </resource-types>
                    </div>
                    <div class="filters__filter select">
                        <label for="resource_topic" class="select__label">
                            Filter by Topic:
                        </label>
                        <resource-topics v-slot="{ resourceTopics }">
                            <select class="select__select" name="resource_topic" v-model="params.topic">
                                <option :value="null" selected>All</option>
                                <option v-for="resourceTopic in resourceTopics" :value="resourceTopic.slug" :key="resourceTopic.id" v-text="resourceTopic.title"></option>
                            </select>
                        </resource-topics>
                    </div>
                </div>

                <div class="cards">
                    <div v-if="resources && !resources.length && !isLoading" class="" v-cloak>No resources found.</div>
                    <div v-else v-for="resource in resources" :key="resource.id" class="cards__card card">
                        <div class="card__container">
                            <img class="card__background" :src="resource.image" :alt="resource.imageAltText">
                            <div class="card__tag -overlay" v-text="resource.type"></div>
                            <h4 class="card__heading">
                                <a :href="resource.url" v-text="resource.title"></a>
                            </h4>
                            <div class="card__content" v-html="resource.description"></div>
                            <div class="card__actions -attached">
                                <a :href="resource.url" v-text="resource.cta" class="card__action button -primary"></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </resources>

{% endblock %}
